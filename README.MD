
# ğŸ“Š Extrator de Tabelas PDF

Aplicativo para extrair tabelas de arquivos PDF e convertÃª-las para Excel de forma automatizada.

## ğŸš€ Funcionalidades

- âœ… **MÃºltiplos mÃ©todos de extraÃ§Ã£o**: Usa Camelot e Tabula para mÃ¡xima compatibilidade
- âœ… **Interface amigÃ¡vel**: Interface web com Streamlit
- âœ… **ConfiguraÃ§Ã£o flexÃ­vel**: Defina os nomes das colunas da tabela
- âœ… **ExportaÃ§Ã£o para Excel**: Salva os resultados em formato .xlsx
- âœ… **Debug automÃ¡tico**: Mostra informaÃ§Ãµes detalhadas sobre tabelas encontradas

## ğŸ“‹ InstalaÃ§Ã£o

1. **Clone ou baixe os arquivos**

2. **Instale as dependÃªncias:**
```bash
pip3 install -r requirements.txt
```

3. **Execute o aplicativo:**
```bash
python3 -m streamlit run app_ui.py
```

## ğŸ’¡ Como usar

### Interface Web (Recomendado)

1. Execute `python3 -m streamlit run app_ui.py`
2. Acesse http://localhost:8501 no navegador
3. FaÃ§a upload do arquivo PDF
4. Informe o nÃºmero de colunas esperado na tabela
5. Digite o nome de cada coluna
6. Clique em "Extrair Tabelas"
7. Baixe o arquivo Excel gerado

### Linha de Comando

```bash
python3 app.py
```

## ğŸ“ Exemplo de uso

Para o PDF anexado (Planilha de PreÃ§o Estimado), use:

- **NÃºmero de colunas**: 6
- **Nomes das colunas**:
  - Item
  - DescriÃ§Ã£o
  - Unid.
  - Quant.
  - Vlr. Unit.
  - Vlr. Total

## ğŸ”§ DependÃªncias

- `streamlit`: Interface web
- `pandas`: ManipulaÃ§Ã£o de dados
- `tabula-py`: ExtraÃ§Ã£o de tabelas (mÃ©todo principal)
- `camelot-py[cv]`: ExtraÃ§Ã£o avanÃ§ada de tabelas
- `openpyxl`: GeraÃ§Ã£o de arquivos Excel
- `xlsxwriter`: FormataÃ§Ã£o de Excel

## ğŸ› ï¸ Melhorias implementadas

1. **MÃºltiplos mÃ©todos de extraÃ§Ã£o**: Camelot + Tabula para maior compatibilidade
2. **ConfiguraÃ§Ãµes automÃ¡ticas**: Testa diferentes parÃ¢metros automaticamente
3. **ğŸ†• RemoÃ§Ã£o de cabeÃ§alhos duplicados**: Remove automaticamente cabeÃ§alhos que se repetem em cada pÃ¡gina
4. **Debug detalhado**: Mostra estrutura das tabelas encontradas para troubleshooting
5. **Tratamento de erros**: RecuperaÃ§Ã£o graceful quando um mÃ©todo falha
6. **Interface melhorada**: Streamlit com upload de arquivos

### âœ¨ Novas Funcionalidades:

#### ğŸ§¹ Limpeza Inteligente de Dados
- âœ… **RemoÃ§Ã£o de CabeÃ§alhos Duplicados**: Remove cabeÃ§alhos repetidos em cada pÃ¡gina
- âœ… **ğŸ†• ConsolidaÃ§Ã£o de Linhas Quebradas**: Junta descriÃ§Ãµes longas que foram quebradas em mÃºltiplas linhas
- âœ… **PreservaÃ§Ã£o de Dados**: NÃ£o perde informaÃ§Ãµes importantes durante a limpeza
- âœ… **Logs detalhados**: Mostra exatamente o que foi processado

#### ğŸ¨ Interface Visual Melhorada
- âœ… **ğŸ›¢ï¸ Imagem personalizada**: Logo do pumper.png na aba, barra lateral e Ã¡rea central
- âœ… **Design profissional**: Cores e estilos personalizados
- âœ… **InstruÃ§Ãµes visuais**: Guia completo na tela inicial
- âœ… **Barra de progresso**: Acompanhe o processo com porcentagem em tempo real
- âœ… **ValidaÃ§Ãµes inteligentes**: Alertas quando PDF nÃ£o Ã© carregado ou campos vazios
- âœ… **EstatÃ­sticas do resultado**: MÃ©tricas dos dados extraÃ­dos
- âœ… **Mensagens informativas**: Dicas de troubleshooting e ajuda

## ğŸ› Troubleshooting

**Problema**: "Nenhuma tabela encontrada"

**SoluÃ§Ãµes**:
1. Verifique se o PDF contÃ©m tabelas com bordas visÃ­veis
2. Confirme se o nÃºmero de colunas estÃ¡ correto
3. Verifique os logs no terminal para mais detalhes
4. Teste com diferentes configuraÃ§Ãµes (o app faz isso automaticamente)

**Problema**: "Tabela com nÃºmero incorreto de colunas"

**SoluÃ§Ãµes**:
1. Conte as colunas manualmente no PDF
2. Verifique se hÃ¡ colunas vazias ou mescladas
3. Analise o output de debug para ver a estrutura real

## ğŸ“ Suporte

Se ainda houver problemas:
1. Verifique os logs detalhados no terminal
2. Teste primeiro com um PDF mais simples
3. Considere usar ferramentas de OCR se o PDF for digitalizado

## ğŸ¯ Status

âœ… **Funcionando**: Interface web Streamlit
âœ… **Funcionando**: ExtraÃ§Ã£o com mÃºltiplos mÃ©todos
âœ… **Funcionando**: ExportaÃ§Ã£o para Excel
âœ… **Funcionando**: Debug e anÃ¡lise de estrutura